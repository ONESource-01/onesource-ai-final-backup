import React, { useState, useEffect, useMemo } from "react";
import { useAuth } from "../contexts/AuthContext";
import PageHeader from "./PageHeader";
import { Card, CardContent, CardHeader, CardTitle } from "./ui/card";
import { Button } from "./ui/button";
import { Input } from "./ui/input";
import { Badge } from "./ui/badge";
import { Alert, AlertDescription } from "./ui/alert";
import { 
  Search, MessageSquare, Mail, Phone, FileText, Video, 
  HelpCircle, Book, Shield, Users, Copyright, Database,
  ExternalLink, ArrowRight, Bot, Lightbulb, MessageCircle,
  Brain, CheckCircle
} from "lucide-react";

const HelpCenter = () => {
  const { user } = useAuth();
  const [searchQuery, setSearchQuery] = useState('');
  const [selectedCategory, setSelectedCategory] = useState('all');
  const [showBotResponse, setShowBotResponse] = useState(null);
  const [botLoading, setBotLoading] = useState(false);

  useEffect(() => {
    document.title = 'Help Centre | ONESource-ai';
  }, []);

  // Preloaded questions about ONESource-ai fundamentals
  const preloadedQuestions = [
    {
      id: 1,
      question: "What is ONESource-ai's 3-Phase AI Intelligence system?",
      category: "ai-intelligence",
      answer: `ONESource-ai's revolutionary 3-Phase AI Intelligence system provides progressively sophisticated construction expertise based on your subscription level:

üß† **Phase 1: Enhanced Prompting** (Starter Plan)
‚Ä¢ Construction-specific prompt templates for different disciplines
‚Ä¢ Industry-focused language and terminology
‚Ä¢ Mandatory compliance references to AS/NZS, NCC, and BCA standards
‚Ä¢ Professional response structure with Technical Answers and Mentoring Insights

‚öôÔ∏è **Phase 2: Workflow Intelligence** (Pro Plan) 
‚Ä¢ Intelligent project stage detection (Concept, Design, Approval, Construction, etc.)
‚Ä¢ Tailored next steps and consultant recommendations based on detected project phase
‚Ä¢ Critical considerations and oversight areas specific to your project stage
‚Ä¢ Smart workflow templates and implementation guidance

üéØ **Phase 3: Specialized Training** (Pro+ Plan)
‚Ä¢ Deep discipline-specific knowledge libraries (Structural, Fire Safety, Sustainability, etc.)
‚Ä¢ Comprehensive standards databases mapped to each specialization
‚Ä¢ Advanced calculation methodologies and professional templates
‚Ä¢ Multi-discipline coordination guidance and specialized workflows

Each phase builds upon the previous, delivering increasingly sophisticated construction intelligence as you progress through subscription tiers.`
    },
    {
      id: 2,
      question: "How does Phase 1: Enhanced Prompting work?",
      category: "ai-intelligence", 
      answer: `**Phase 1: Enhanced Prompting** transforms generic AI responses into construction-specific expertise:

üèóÔ∏è **Discipline-Specific Templates:**
‚Ä¢ Structural Engineering: AS 1170 focus with structural design loads
‚Ä¢ Building Codes: NCC/BCA compliance with specific clause references
‚Ä¢ Fire Safety: AS 1851, AS 3786 integration with system requirements
‚Ä¢ Sustainability: Green Star and NABERS framework alignment
‚Ä¢ MEP Systems: AS/NZS standards for mechanical, electrical, plumbing

üìã **Professional Response Structure:**
‚Ä¢ üõ†Ô∏è Technical Answer: Detailed standards, calculations, compliance paths
‚Ä¢ üßê Mentoring Insight: Practical guidance and industry best practices
‚Ä¢ üìã Next Steps: Clear actionable recommendations

‚úÖ **Compliance Focus:**
‚Ä¢ Mandatory AS/NZS standard references with current editions
‚Ä¢ NCC and BCA section citations where applicable
‚Ä¢ State-specific regulatory variations noted
‚Ä¢ Professional certification requirements highlighted

**Available to:** All users (Starter Plan and above)
**Benefit:** Eliminates generic AI responses, ensures construction industry relevance`
    },
    {
      id: 3,
      question: "What advantages does Phase 2: Workflow Intelligence provide?",
      category: "ai-intelligence",
      answer: `**Phase 2: Workflow Intelligence** intelligently detects your project stage and provides targeted guidance:

üéØ **Smart Stage Detection:**
‚Ä¢ **Concept Planning:** Site analysis, preliminary budgets, council pre-application
‚Ä¢ **Design Development:** Architectural drawings, structural engineering, services design
‚Ä¢ **Regulatory Approval:** Building consent applications, engineering certificates
‚Ä¢ **Procurement:** Tender documentation, contractor selection, contract negotiation
‚Ä¢ **Construction:** Site inspections, quality control, progress management
‚Ä¢ **Completion:** Final inspections, defects rectification, handover processes

‚öôÔ∏è **Intelligent Recommendations:**
‚Ä¢ Stage-specific next steps tailored to your project phase
‚Ä¢ Key consultant recommendations (Architect, Engineer, Certifier, etc.)
‚Ä¢ Critical considerations and common oversight areas
‚Ä¢ Typical timeline expectations and milestone planning

üß† **Professional Guidance:**
‚Ä¢ Industry best practices for each project stage
‚Ä¢ Risk mitigation strategies specific to your phase
‚Ä¢ Coordination requirements between disciplines
‚Ä¢ Authority liaison and approval processes

**Available to:** Pro Plan subscribers and above
**Benefit:** Eliminates guesswork, provides expert project management guidance at every stage`
    },
    {
      id: 4,
      question: "How does Phase 3: Specialized Training enhance my expertise?",
      category: "ai-intelligence",
      answer: `**Phase 3: Specialized Training** delivers deep, discipline-specific construction expertise:

üèóÔ∏è **Comprehensive Knowledge Libraries:**
‚Ä¢ **Structural:** Complete AS 1170 series, AS 3600 concrete, AS 4100 steel design
‚Ä¢ **Fire Safety:** AS 1851 maintenance, AS 3786 detection, egress calculations
‚Ä¢ **Sustainability:** Green Star criteria, NABERS protocols, energy modeling
‚Ä¢ **Building Codes:** Full NCC interpretation, alternative solutions, DTS compliance
‚Ä¢ **MEP Systems:** AS/NZS hydraulic, electrical, mechanical integration

üìä **Advanced Capabilities:**
‚Ä¢ Complex calculation methodologies with step-by-step guidance
‚Ä¢ Cross-standard compliance checking and conflict resolution
‚Ä¢ Multi-discipline coordination protocols and interface management
‚Ä¢ Performance-based solution development and documentation

üéØ **Professional Templates:**
‚Ä¢ Design calculation templates for common scenarios  
‚Ä¢ Compliance checklists and verification procedures
‚Ä¢ Professional certification pathways and requirements
‚Ä¢ Quality assurance protocols and testing procedures

‚ö° **Specialized Features:**
‚Ä¢ Advanced comparison tables across jurisdictions
‚Ä¢ Historical standard changes and transition guidance
‚Ä¢ Industry-specific workflows and best practice protocols
‚Ä¢ Professional development recommendations and certifications

**Available to:** Pro+ Plan subscribers
**Benefit:** Access to specialist-level expertise across all major construction disciplines`
    },
    {
      id: 5,
      question: "How do System Prompts and Mentoring Responses work behind the scenes?",
      category: "ai-intelligence",
      answer: `ONESource-ai uses sophisticated system prompts and intelligent mentoring to deliver personalized construction expertise:

## **üß† System Prompts - The AI's Expert Identity**

**What They Do:**
System prompts are detailed instructions that transform generic AI into specialized construction experts. Think of them as "expert personalities" that the AI adopts based on your question.

**How They Work:**
1. **Question Analysis:** System detects discipline (structural, fire safety, etc.) and sector (commercial, residential, etc.) from your question content
2. **Expert Selection:** Chooses appropriate expert prompt from 40+ construction disciplines
3. **Context Application:** AI responds as that specific type of expert with relevant standards, terminology, and approach

**Example in Action:**
- **Fire Safety Question:** AI becomes fire safety engineer, references AS 1851, AS 3786, NCC Volume One
- **Structural Question:** AI becomes structural engineer, uses AS 1170, AS 3600, AS 4100 standards
- **Cost Question:** AI becomes quantity surveyor, applies cost estimation principles and market analysis

## **üéØ Intelligent Mentoring Cross-Reference System**

**The Smart Translation:**
When you ask about disciplines outside your expertise, ONESource-ai provides expert technical answers BUT personalizes the mentoring insights back to your actual professional background.

**How Cross-Referencing Works:**
1. **Your Profile:** System reads your selected disciplines and industry sectors from user profile
2. **Question Detection:** Identifies what discipline/sector the question is about
3. **Expert Technical Answer:** Provides full expert-level answer for the asked discipline
4. **Personalized Mentoring:** Translates guidance back to YOUR expertise areas

**Real Example:**
- **Your Profile:** Structural Engineer + Commercial Buildings
- **Question Asked:** "Fire safety requirements for hospitals"
- **Technical Answer:** Complete fire safety expert guidance for healthcare facilities
- **Mentoring Insight:** *"As a structural engineer working primarily in commercial buildings, here's how these healthcare fire safety requirements will impact your structural design considerations when working on hospital projects..."*

## **üîÑ Multiple Expertise Handling**

**Smart Display for Multiple Specializations:**
- **Single expertise:** "As a structural engineer working in commercial sector..."
- **Multiple expertise:** "As a structural/hydraulic/civil engineer working in commercial/healthcare sectors..."

## **‚öôÔ∏è Behind the Scenes Process**

**Step-by-Step System Operation:**
1. **Content Analysis:** Keyword detection identifies required expertise (40+ disciplines, 17 sectors)
2. **User Profile Check:** Reads your selected professional areas
3. **Prompt Assembly:** Combines expert system prompt + user context + subscription tier features
4. **Response Generation:** AI responds as expert in asked discipline
5. **Mentoring Translation:** Personalizes guidance back to your actual expertise
6. **Tier Gating:** Delivers Phase 1/2/3 intelligence based on subscription level

**This intelligent system ensures you get expert-level answers for any construction topic while receiving mentoring guidance tailored specifically to your professional background.**`
    },
    {
      id: 6,
      question: "How does ONESource-ai handle my privacy when I load documents?",
      category: "privacy",
      answer: `ONESource-ai takes your document privacy seriously:

**Personal Knowledge Bank:**
‚Ä¢ Your uploaded documents are stored in your private Personal Knowledge Bank
‚Ä¢ Only you can access your uploaded documents
‚Ä¢ Documents are used exclusively to enhance YOUR AI responses
‚Ä¢ We use enterprise-grade encryption for all document storage
‚Ä¢ Documents are never shared with other users or partners

**Data Processing:**
‚Ä¢ Documents are processed to create searchable indexes
‚Ä¢ Original documents remain unchanged and secure
‚Ä¢ Processing happens in secure, isolated environments
‚Ä¢ You maintain full ownership and control of your content

**Retention & Deletion:**
‚Ä¢ You can delete documents at any time through your profile
‚Ä¢ Deleted documents are immediately removed from our systems
‚Ä¢ No permanent copies are retained after deletion

**Compliance:**
‚Ä¢ We comply with Australian Privacy Act 1988
‚Ä¢ GDPR compliant for international users
‚Ä¢ Regular security audits and penetration testing
‚Ä¢ SOC 2 Type II compliance for data handling`
    },
    {
      id: 2,
      question: "How does ONESource-ai show me partner information through the Community Knowledge Bank?",
      category: "community",
      answer: `The Community Knowledge Bank provides verified partner content with full transparency:

**Partner Verification Process:**
‚Ä¢ All partners must provide valid ABN/ACN registration
‚Ä¢ Technical content is reviewed by our expert team
‚Ä¢ Only verified industry professionals can contribute
‚Ä¢ Content must comply with AU/NZ building standards

**Content Attribution:**
‚Ä¢ Every piece of partner content shows clear attribution
‚Ä¢ Partner company name and verification status displayed
‚Ä¢ You can see exactly which partner provided the information
‚Ä¢ Contact details available for verified partners

**Content Quality:**
‚Ä¢ All partner content undergoes technical review
‚Ä¢ Content must include proper references to standards
‚Ä¢ Regular updates ensure information remains current
‚Ä¢ User feedback helps maintain content quality

**How It Works:**
‚Ä¢ When AI references partner content, it shows the source
‚Ä¢ Partner materials are clearly marked with verification badges
‚Ä¢ You can filter responses to include/exclude partner content
‚Ä¢ Full transparency about which sources inform your answers`
    },
    {
      id: 3,
      question: "How does ONESource-ai handle copyright materials?",
      category: "copyright",
      answer: `ONESource-ai maintains strict copyright compliance:

**User Uploads (Personal Knowledge Bank):**
‚Ä¢ You must have rights to upload any documents
‚Ä¢ Upload constitutes confirmation you own or have permission to use content
‚Ä¢ We don't claim ownership of your uploaded materials
‚Ä¢ Your content remains your intellectual property

**Partner Content (Community Knowledge Bank):**
‚Ä¢ Partners confirm they have rights to share their content
‚Ä¢ All partner agreements include IP indemnification clauses
‚Ä¢ Partners retain ownership of their contributed materials
‚Ä¢ Proper attribution maintained for all partner content

**AI Training & Responses:**
‚Ä¢ We don't train our AI models on copyrighted content without permission
‚Ä¢ Responses reference publicly available standards and codes
‚Ä¢ Fair use principles applied for educational and guidance purposes
‚Ä¢ Original source attribution provided where applicable

**Compliance Measures:**
‚Ä¢ DMCA takedown procedures in place
‚Ä¢ Regular IP compliance audits
‚Ä¢ Legal review of all content partnerships
‚Ä¢ Clear terms of use for all users and partners

**If You Suspect Infringement:**
‚Ä¢ Contact support@onesource-ai.com immediately
‚Ä¢ Include details of alleged infringement
‚Ä¢ We investigate and respond within 48 hours
‚Ä¢ Proper remediation taken when required`
    },
    {
      id: 4,
      question: "What construction standards does ONESource-ai cover?",
      category: "standards",
      answer: `ONESource-ai considers **all relevant AU/NZ standards that are available to the AI agent across all disciplines and sectors of the construction industry**.

**Comprehensive Standards Coverage:**
ONESource-ai has access to and considers the full spectrum of Australian and New Zealand construction standards, codes, and regulations that are publicly available and relevant to your specific query, including:

**All Construction Disciplines:**
‚Ä¢ Architecture and building design standards
‚Ä¢ Structural engineering (concrete, steel, timber, masonry)
‚Ä¢ Fire safety and protection systems
‚Ä¢ HVAC, mechanical, and hydraulic services
‚Ä¢ Electrical engineering and systems
‚Ä¢ Civil engineering and infrastructure
‚Ä¢ Geotechnical and foundation standards
‚Ä¢ Environmental and sustainability requirements
‚Ä¢ Accessibility and universal design codes

**All Construction Sectors:**
‚Ä¢ Residential construction (single dwelling to high-rise)
‚Ä¢ Commercial and office buildings
‚Ä¢ Industrial and manufacturing facilities
‚Ä¢ Healthcare and aged care facilities
‚Ä¢ Educational institutions
‚Ä¢ Retail and hospitality venues
‚Ä¢ Infrastructure and civil works
‚Ä¢ Specialized facilities (data centers, laboratories, etc.)

**Dynamic Standards Integration:**
Rather than being limited to a fixed list, ONESource-ai intelligently identifies and applies the most current and relevant AU/NZ standards based on your specific question, project type, and context. This includes Australian Standards (AS/NZS), National Construction Code (NCC), New Zealand Building Code (NZBC), and industry-specific codes and guidelines.

**Key Advantage:**
Our AI doesn't just reference standards - it understands how they interconnect across disciplines and applies the most relevant combination for your specific construction challenge, ensuring comprehensive compliance guidance across the entire AU/NZ construction industry.`
    },
    {
      id: 5,
      question: "How accurate are ONESource-ai responses?",
      category: "accuracy",
      answer: `ONESource-ai maintains high accuracy through multiple quality measures:

**AI Training & Validation:**
‚Ä¢ Trained on verified AU/NZ construction standards
‚Ä¢ Regular model updates with latest code changes
‚Ä¢ Validation against official technical documents
‚Ä¢ Continuous learning from user feedback

**Expert Review Process:**
‚Ä¢ Technical content reviewed by qualified engineers
‚Ä¢ Partner content verified by industry professionals
‚Ä¢ Regular accuracy audits of AI responses
‚Ä¢ Correction system for identified errors

**Source Attribution:**
‚Ä¢ Every response includes relevant standard references
‚Ä¢ Clear indication when information comes from partner content
‚Ä¢ Links to official documentation where available
‚Ä¢ Distinction between general guidance and specific requirements

**Limitation Acknowledgment:**
‚Ä¢ AI provides guidance, not professional engineering advice
‚Ä¢ Complex projects require qualified professional consultation
‚Ä¢ Responses should be verified against current standards
‚Ä¢ Regional variations may require local expert confirmation

**Quality Assurance:**
‚Ä¢ Feedback system for users to report inaccuracies
‚Ä¢ Regular updates based on user corrections
‚Ä¢ Professional review of flagged responses
‚Ä¢ Continuous improvement based on user interactions`
    },
    {
      id: 6,
      question: "Can I use ONESource-ai for regulatory submissions?",
      category: "regulatory",
      answer: `ONESource-ai is a guidance tool, not a substitute for professional services:

**Appropriate Use:**
‚Ä¢ Research and preliminary guidance
‚Ä¢ Understanding code requirements
‚Ä¢ Preparing for professional consultations
‚Ä¢ Educational and learning purposes
‚Ä¢ Design concept development

**Professional Requirements:**
‚Ä¢ Building consent applications require registered professionals
‚Ä¢ Structural designs need qualified engineers
‚Ä¢ Fire engineering requires certified specialists
‚Ä¢ Local authority submissions need licensed practitioners

**How ONESource-ai Helps:**
‚Ä¢ Provides foundation knowledge for discussions with professionals
‚Ä¢ Helps identify relevant standards and codes
‚Ä¢ Assists in understanding compliance pathways
‚Ä¢ Supports professional development and learning

**Best Practice Approach:**
1. Use ONESource-ai for initial research and understanding
2. Identify relevant standards and requirements
3. Consult with qualified professionals for specific applications
4. Verify all guidance against current official standards
5. Obtain professional certification for regulatory submissions

**Professional Network:**
‚Ä¢ We can connect you with verified industry partners
‚Ä¢ Partner directory includes qualified professionals
‚Ä¢ Professional development resources available
‚Ä¢ Continuing education opportunities promoted`
    },
    {
      id: 7,
      question: "How does ONESource-ai adapt responses based on my experience level?",
      category: "personalization",
      answer: `ONESource-ai personalizes every response based on your selected experience level to provide the most appropriate guidance:

**Graduate / Beginner (0-2 years):**
‚Ä¢ AI provides detailed explanations, step-by-step guidance, educational context, and mentoring advice
‚Ä¢ Perfect for learning fundamental concepts and building confidence

**Response Examples:**
‚Ä¢ Explains basic concepts like "What is a fire rating?" before discussing specific requirements
‚Ä¢ Provides step-by-step compliance checklists with explanations for each step
‚Ä¢ Includes educational context: "This requirement exists because..." with safety rationale
‚Ä¢ Offers learning resources and suggests professional development pathways

**Intermediate (3-7 years):**
‚Ä¢ AI offers practical solutions with moderate detail, focuses on real-world applications
‚Ä¢ Provides tips for professional development and efficiency improvements

**Response Examples:**
‚Ä¢ Provides practical solutions: "For this scenario, you could use Method A or B, here's when to choose each"
‚Ä¢ Focuses on real-world applications and common challenges you'll face
‚Ä¢ Includes efficiency tips: "Pro tip: This calculation can be simplified by..."
‚Ä¢ Suggests when to consult specialists and what questions to ask them

**Senior (8-15 years):**
‚Ä¢ AI provides advanced technical insights, discusses complex scenarios
‚Ä¢ Offers strategic perspectives and focuses on leadership and decision-making aspects

**Response Examples:**
‚Ä¢ Discusses complex scenarios: "When dealing with conflicting code requirements, consider..."
‚Ä¢ Offers strategic perspectives on project risks and mitigation strategies
‚Ä¢ Focuses on leadership aspects: "When presenting this to stakeholders, emphasize..."
‚Ä¢ Provides advanced technical insights and alternative design approaches

**Expert / Principal (15+ years):**
‚Ä¢ AI delivers concise, high-level insights, focuses on innovation and cutting-edge practices
‚Ä¢ Discusses industry trends and provides expert-to-expert technical discourse

**Response Examples:**
‚Ä¢ Delivers concise, high-level insights without basic explanations
‚Ä¢ Discusses cutting-edge practices and emerging industry trends
‚Ä¢ Provides expert-to-expert technical discourse with advanced terminology
‚Ä¢ Focuses on innovation opportunities and industry leadership perspectives

**Why This Matters:**
Selecting the correct experience level ensures you receive responses that match your expertise, learning style, and professional needs. This personalization makes ONESource-ai more effective and relevant to your specific career stage.`
    },
    {
      id: 8,
      question: "How does the Community Knowledge Bank work?",
      category: "community",
      answer: `The Community Knowledge Bank is a shared resource where construction industry partners contribute verified technical content:

**Partner Contributions:**
‚Ä¢ **Verified Organizations**: Only approved industry partners can contribute content
‚Ä¢ **Quality Assurance**: All partner content undergoes technical review
‚Ä¢ **Proper Attribution**: Every response clearly identifies the contributing organization
‚Ä¢ **Current Information**: Partners keep their content updated with latest practices

**Content Types:**
‚Ä¢ Technical specifications and standards interpretations
‚Ä¢ Best practice guides and methodologies  
‚Ä¢ Product technical data and installation guides
‚Ä¢ Compliance checklists and verification procedures
‚Ä¢ Regional variations and local authority requirements

**User Benefits:**
‚Ä¢ **Enhanced Responses**: AI draws from both general knowledge and partner-specific expertise
‚Ä¢ **Industry Insights**: Access to real-world applications and case studies
‚Ä¢ **Trusted Sources**: Content comes from established construction professionals
‚Ä¢ **Attribution Transparency**: Always know the source of specialized information

**Content Management:**
‚Ä¢ Partners control their own content updates
‚Ä¢ Users can provide feedback on partner content quality
‚Ä¢ Regular auditing ensures accuracy and relevance
‚Ä¢ Integration with personal knowledge for comprehensive guidance

**Privacy & Control:**
‚Ä¢ Community content is searchable by all users
‚Ä¢ Personal Knowledge Bank remains completely private
‚Ä¢ Clear distinction between community and personal content sources
‚Ä¢ User choice in how much to rely on community vs personal content`
    },
    {
      id: 9,
      question: "How does AI personalization work with my industry experience?",
      category: "personalization",
      answer: `ONESource-ai personalizes every response based on your selected experience level to provide the most appropriate guidance:

**Graduate / Beginner (0-2 years):**
‚Ä¢ AI provides detailed explanations, step-by-step guidance, educational context, and mentoring advice
‚Ä¢ Perfect for learning fundamental concepts and building confidence

**Response Examples:**
‚Ä¢ Explains basic concepts like "What is a fire rating?" before discussing specific requirements
‚Ä¢ Provides step-by-step compliance checklists with explanations for each step
‚Ä¢ Includes educational context: "This requirement exists because..." with safety rationale
‚Ä¢ Offers learning resources and suggests professional development pathways

**Intermediate (3-7 years):**
‚Ä¢ AI offers practical solutions with moderate detail, focuses on real-world applications
‚Ä¢ Provides tips for professional development and efficiency improvements

**Response Examples:**
‚Ä¢ Provides practical solutions: "For this scenario, you could use Method A or B, here's when to choose each"
‚Ä¢ Focuses on real-world applications and common challenges you'll face
‚Ä¢ Includes efficiency tips: "Pro tip: This calculation can be simplified by..."
‚Ä¢ Suggests when to consult specialists and what questions to ask them

**Senior (8-15 years):**
‚Ä¢ AI provides advanced technical insights, discusses complex scenarios
‚Ä¢ Offers strategic perspectives and focuses on leadership and decision-making aspects

**Response Examples:**
‚Ä¢ Discusses complex scenarios: "When dealing with conflicting code requirements, consider..."
‚Ä¢ Offers strategic perspectives on project risks and mitigation strategies
‚Ä¢ Focuses on leadership aspects: "When presenting this to stakeholders, emphasize..."
‚Ä¢ Provides advanced technical insights and alternative design approaches

**Expert / Principal (15+ years):**
‚Ä¢ AI delivers concise, high-level insights, focuses on innovation and cutting-edge practices
‚Ä¢ Discusses industry trends and provides expert-to-expert technical discourse

**Response Examples:**
‚Ä¢ Delivers concise, high-level insights without basic explanations
‚Ä¢ Discusses cutting-edge practices and emerging industry trends
‚Ä¢ Provides expert-to-expert technical discourse with advanced terminology
‚Ä¢ Focuses on innovation opportunities and industry leadership perspectives

**Why This Matters:**
Selecting the correct experience level ensures you receive responses that match your expertise, learning style, and professional needs. This personalization makes ONESource-ai more effective and relevant to your specific career stage.`
    }
  ];

  // FAQ Articles based on web crawl data
  const faqArticles = [
    {
      id: 101,
      title: "Understanding NCC 2025 Energy Efficiency Updates",
      category: "standards",
      excerpt: "New thermal performance and insulation requirements for Australian construction",
      content: `The National Construction Code (NCC) 2025 introduces stricter energy efficiency standards for new constructions and major renovations. Key changes include:

**Enhanced Thermal Performance:**
‚Ä¢ Improved R-value requirements for wall and roof insulation
‚Ä¢ Stricter glazing performance standards
‚Ä¢ Enhanced air sealing requirements

**HVAC System Updates:**
‚Ä¢ Higher efficiency ratings for heating and cooling systems
‚Ä¢ Mandatory commissioning for commercial HVAC installations
‚Ä¢ Smart controls integration requirements

**Compliance Pathways:**
‚Ä¢ Simplified verification methods
‚Ä¢ New modelling software acceptance criteria
‚Ä¢ Alternative solution pathway clarifications`
    },
    {
      id: 102,
      title: "AS 1851-2012 Fire System Maintenance Changes",
      category: "fire-safety",
      excerpt: "February 2025 amendments to fire protection system maintenance requirements",
      content: `The updated AS 1851-2012 standard, effective February 13, 2025, introduces significant changes:

**Enhanced Record Keeping:**
‚Ä¢ Detailed digital records mandatory
‚Ä¢ Cloud-based system integration
‚Ä¢ Real-time compliance tracking

**Inspection Frequency Updates:**
‚Ä¢ Monthly visual inspections for critical systems
‚Ä¢ Quarterly functional testing requirements
‚Ä¢ Annual comprehensive assessments

**Penalty Framework:**
‚Ä¢ Building owner liability clearly defined
‚Ä¢ Professional indemnity requirements
‚Ä¢ Compliance certification processes`
    },
    {
      id: 103,
      title: "New Zealand Building Code Streamlining",
      category: "standards",
      excerpt: "Simplified process for using overseas building products in NZ construction",
      content: `The NZ Government's Building Product Specifications document makes it easier to use international products:

**Acceptable Solutions:**
‚Ä¢ Pre-approved overseas product categories
‚Ä¢ Verification method simplification
‚Ä¢ Reduced compliance documentation

**International Standards Recognition:**
‚Ä¢ European CE marking acceptance
‚Ä¢ North American standards equivalency
‚Ä¢ Australian standard cross-recognition

**Implementation Process:**
‚Ä¢ Building consent pathway clarification
‚Ä¢ Professional responsibility frameworks
‚Ä¢ Quality assurance requirements`
    },
    {
      id: 104,
      title: "HVAC Fire Safety Requirements 2025",
      category: "mechanical",
      excerpt: "Updated fire safety standards for mechanical ventilation systems",
      content: `New HVAC fire safety requirements emphasize comprehensive system protection:

**Ventilation Standards:**
‚Ä¢ AS 1668.2:2024 compliance mandatory
‚Ä¢ Enhanced smoke control provisions
‚Ä¢ Emergency ventilation protocols

**Fire Resistance Ratings:**
‚Ä¢ Ductwork fire resistance requirements
‚Ä¢ Penetration sealing standards
‚Ä¢ Service shaft protection measures

**Maintenance & Testing:**
‚Ä¢ Regular fire damper testing
‚Ä¢ Smoke evacuation system verification
‚Ä¢ Professional certification requirements`
    }
  ];

  // Popular articles combining both categories
  const popularArticles = [...preloadedQuestions, ...faqArticles];

  const categories = [
    { id: 'all', name: 'All Topics', icon: Book },
    { id: 'ai-intelligence', name: '3-Phase AI Intelligence', icon: Brain },
    { id: 'privacy', name: 'Privacy & Security', icon: Shield },
    { id: 'community', name: 'Community Knowledge', icon: Users },
    { id: 'copyright', name: 'Copyright & IP', icon: Copyright },
    { id: 'standards', name: 'Building Standards', icon: FileText },
    { id: 'fire-safety', name: 'Fire Safety', icon: Lightbulb },
    { id: 'mechanical', name: 'Mechanical Services', icon: MessageCircle },
    { id: 'personalization', name: 'AI Personalization', icon: Brain },
    { id: 'accuracy', name: 'Accuracy & Quality', icon: CheckCircle },
    { id: 'regulatory', name: 'Regulatory Use', icon: HelpCircle }
  ];

  const handleBotQuestion = async (question) => {
    setBotLoading(true);
    setShowBotResponse({
      question: question.question,
      answer: question.answer,
      category: question.category
    });
    
    // Simulate AI processing time
    setTimeout(() => {
      setBotLoading(false);
    }, 1500);
  };

  const filteredArticles = useMemo(() => {
    console.log('Filtering articles with searchQuery:', searchQuery, 'selectedCategory:', selectedCategory);
    
    const filtered = popularArticles.filter(article => {
      const matchesCategory = selectedCategory === 'all' || article.category === selectedCategory;
      
      // Search in multiple fields including content/answer
      const searchLower = searchQuery.toLowerCase();
      const matchesSearch = searchQuery === '' || // Show all when search is empty
                           article.title?.toLowerCase().includes(searchLower) ||
                           article.question?.toLowerCase().includes(searchLower) ||
                           article.excerpt?.toLowerCase().includes(searchLower) ||
                           article.answer?.toLowerCase().includes(searchLower) ||
                           article.content?.toLowerCase().includes(searchLower);
      
      const result = matchesCategory && matchesSearch;
      
      // Debug logging for articles containing "standards"
      if (searchQuery.toLowerCase() === 'standards') {
        console.log(`Article ${article.id}: "${article.question || article.title}"`, {
          matchesCategory,
          matchesSearch,
          result,
          hasTitle: !!article.title?.toLowerCase().includes('standards'),
          hasQuestion: !!article.question?.toLowerCase().includes('standards'),
          hasAnswer: !!article.answer?.toLowerCase().includes('standards'),
          hasContent: !!article.content?.toLowerCase().includes('standards'),
          hasExcerpt: !!article.excerpt?.toLowerCase().includes('standards')
        });
      }
      
      return result;
    });
    
    console.log(`Filtered ${filtered.length} articles from ${popularArticles.length} total`);
    return filtered;
  }, [searchQuery, selectedCategory, popularArticles]);

  const handleContactSupport = (type) => {
    const emails = {
      support: 'support@onesource-ai.com?subject=Support%20Request',
      feedback: 'support@onesource-ai.com?subject=Feedback',
      accounts: 'support@onesource-ai.com?subject=Account%20Issue'
    };
    window.location.href = `mailto:${emails[type]}`;
  };

  const handleSuggestSource = () => {
    window.location.href = 'mailto:support@onesource-ai.com?subject=Knowledge%20Bank%20Ideas%20-%20Source%20Suggestion';
  };

  return (
    <>
      <PageHeader 
        title="Help Centre" 
        subtitle="Get help, find answers, and learn about ONESource-ai's construction industry expertise platform"
      />
      
      <div className="max-w-7xl mx-auto p-6" style={{ backgroundColor: '#f8fafc', minHeight: 'calc(100vh - 200px)' }}>
        
        {/* Back to Chat Button */}
        <div className="mb-6">
          <Button
            onClick={() => window.location.href = '/chat'}
            variant="outline"
            className="flex items-center gap-2"
          >
            <ArrowRight className="h-4 w-4 rotate-180" />
            Back to Chat
          </Button>
        </div>

        {/* Search Bar */}
        <div className="mb-8">
          <Card>
            <CardContent className="p-6">
              <div className="relative max-w-2xl mx-auto">
                <Search className="absolute left-3 top-3 h-5 w-5 text-gray-400 pointer-events-none" />
                <input
                  type="text"
                  placeholder="Search help articles, FAQ, and system information..."
                  value={searchQuery}
                  onChange={(e) => {
                    console.log('Search input changed:', e.target.value);
                    setSearchQuery(e.target.value);
                  }}
                  className="flex h-9 w-full rounded-md border border-gray-300 bg-transparent pl-10 pr-4 py-3 text-lg shadow-sm transition-colors placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-blue-500 disabled:cursor-not-allowed disabled:opacity-50"
                />
              </div>
            </CardContent>
          </Card>
        </div>

        {/* Category Filters */}
        <div className="mb-8">
          <div className="flex flex-wrap gap-3 justify-center">
            {categories.map((category) => {
              const IconComponent = category.icon;
              return (
                <Button
                  key={category.id}
                  variant={selectedCategory === category.id ? "default" : "outline"}
                  onClick={() => {
                    setSelectedCategory(category.id);
                    setShowBotResponse(null); // Clear AI response when switching categories
                  }}
                  className={`flex items-center gap-2 ${
                    selectedCategory === category.id 
                      ? 'bg-onesource-medium text-white hover:bg-onesource-dark' 
                      : 'bg-onesource-light text-white hover:bg-onesource-medium border-onesource-light'
                  }`}
                >
                  <IconComponent className="h-4 w-4" />
                  {category.name}
                </Button>
              );
            })}
          </div>
        </div>

        <div className="grid lg:grid-cols-3 gap-8">
          
          {/* Main Content Area */}
          <div className="lg:col-span-2 space-y-8">
            
            {/* Bot Response Area */}
            {showBotResponse && (
              <Card className="border-2 border-onesource-pale bg-onesource-white">
                <CardHeader>
                  <CardTitle className="flex items-center gap-2 text-onesource-dark">
                    <img src="/onesource-icon.png" alt="ONESource-ai" className="h-5 w-5" />
                    ONESource-ai Assistant
                  </CardTitle>
                </CardHeader>
                <CardContent>
                  {botLoading ? (
                    <div className="flex items-center gap-2">
                      <div className="animate-spin rounded-full h-4 w-4 border-b-2 border-onesource-dark"></div>
                      <span className="text-onesource-medium">Thinking...</span>
                    </div>
                  ) : (
                    <div className="space-y-3">
                      <p className="font-medium text-onesource-dark">{showBotResponse.question}</p>
                      <div className="prose prose-sm max-w-none text-gray-700">
                        {showBotResponse.answer.split('\n').map((paragraph, index) => (
                          <div key={index} className="mb-2">
                            {paragraph.startsWith('**') && paragraph.endsWith(':**') ? (
                              <h4 className="font-semibold text-onesource-dark mb-1">{paragraph.slice(2, -2)}</h4>
                            ) : paragraph.startsWith('‚Ä¢') ? (
                              <div className="ml-4 mb-1">{paragraph}</div>
                            ) : paragraph.trim() ? (
                              <p dangerouslySetInnerHTML={{
                                __html: paragraph
                                  .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                                  .replace(/\*(.*?)\*/g, '<em>$1</em>')
                              }} />
                            ) : null}
                          </div>
                        ))}
                      </div>
                    </div>
                  )}
                </CardContent>
              </Card>
            )}

            {/* Popular Articles & FAQ */}
            <div>
              <h2 className="text-2xl font-bold mb-6" style={{ color: '#0f2f57' }}>
                Popular Articles & FAQ
              </h2>
              
              {filteredArticles.length === 0 ? (
                <Card>
                  <CardContent className="p-8 text-center">
                    <HelpCircle className="h-12 w-12 text-gray-400 mx-auto mb-4" />
                    <p className="text-gray-600 mb-4">
                      ONESource-ai is continuing to build their knowledge banks.
                    </p>
                    <p className="text-sm text-gray-500 mb-4">
                      Would you like to suggest a source or topic to add to our knowledge base?
                    </p>
                    <Button onClick={handleSuggestSource} className="bg-onesource-dark hover:bg-onesource-medium text-white">
                      Suggest Knowledge Source
                    </Button>
                  </CardContent>
                </Card>
              ) : (
                <div key={selectedCategory} className="space-y-4">
                  {filteredArticles.map((article) => (
                    <Card key={article.id} className="hover:shadow-md transition-shadow">
                      <CardContent className="p-6">
                        <div className="flex items-start justify-between">
                          <div className="flex-1">
                            <div className="flex items-center gap-2 mb-2">
                              {article.question ? (
                                <MessageSquare className="h-4 w-4 text-blue-600" />
                              ) : (
                                <FileText className="h-4 w-4 text-green-600" />
                              )}
                              <Badge variant="outline" className="text-xs">
                                {categories.find(c => c.id === article.category)?.name || article.category}
                              </Badge>
                            </div>
                            <h3 className="text-lg font-semibold mb-2" style={{ color: '#0f2f57' }}>
                              {article.question || article.title}
                            </h3>
                            {article.excerpt && (
                              <p className="text-gray-600 text-sm mb-3">{article.excerpt}</p>
                            )}
                            <Button
                              variant="outline"
                              size="sm"
                              onClick={() => article.question ? handleBotQuestion(article) : null}
                              className="text-onesource-dark hover:text-onesource-medium"
                            >
                              {article.question ? 'Ask AI Assistant' : 'Read Article'}
                              <ArrowRight className="h-3 w-3 ml-1" />
                            </Button>
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  ))}
                </div>
              )}
            </div>
          </div>

          {/* Sidebar */}
          <div className="space-y-6">
            
            {/* Quick Actions */}
            <Card>
              <CardHeader>
                <CardTitle className="text-lg" style={{ color: '#0f2f57' }}>Quick Actions</CardTitle>
              </CardHeader>
              <CardContent className="space-y-3">
                
                {/* Contact Options */}
                <Button
                  variant="outline"
                  className="w-full justify-start"
                  onClick={() => handleContactSupport('support')}
                >
                  <Mail className="h-4 w-4 mr-2" />
                  Contact Support
                </Button>
                
                <Button
                  variant="outline"
                  className="w-full justify-start"
                  onClick={() => handleContactSupport('feedback')}
                >
                  <MessageSquare className="h-4 w-4 mr-2" />
                  Send Feedback
                </Button>
                
                <Button
                  variant="outline"
                  className="w-full justify-start"
                  onClick={() => handleContactSupport('accounts')}
                >
                  <HelpCircle className="h-4 w-4 mr-2" />
                  Account Issues
                </Button>
                
                {/* Knowledge Vault Link */}
                <Button
                  variant="outline"
                  className="w-full justify-start"
                  onClick={() => window.location.href = '/knowledge'}
                >
                  <Database className="h-4 w-4 mr-2" />
                  Knowledge Vault
                </Button>
                
                {/* Video Tutorials - Coming Soon */}
                <div className="relative">
                  <Button
                    variant="outline"
                    className="w-full justify-start opacity-60"
                    disabled
                  >
                    <Video className="h-4 w-4 mr-2" />
                    Video Tutorials
                  </Button>
                  <Badge className="absolute -top-2 -right-2 text-xs bg-orange-100 text-orange-800 border-orange-200">
                    Soon
                  </Badge>
                </div>
              </CardContent>
            </Card>

            {/* Contact Information */}
            <Card>
              <CardHeader>
                <CardTitle className="text-lg" style={{ color: '#0f2f57' }}>Need More Help?</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-3 text-sm">
                  <div className="flex items-start gap-2">
                    <Mail className="h-4 w-4 mt-1 text-blue-600" />
                    <div>
                      <p className="font-medium">Email Support</p>
                      <a 
                        href="mailto:support@onesource-ai.com" 
                        className="text-blue-600 hover:underline"
                      >
                        support@onesource-ai.com
                      </a>
                    </div>
                  </div>
                  
                  <div className="pt-3 border-t border-gray-200">
                    <p className="text-xs text-gray-500">
                      Response time: Within 24 hours during business days
                    </p>
                  </div>
                </div>
              </CardContent>
            </Card>

            {/* System Status */}
            <Card>
              <CardHeader>
                <CardTitle className="text-lg" style={{ color: '#0f2f57' }}>System Status</CardTitle>
              </CardHeader>
              <CardContent>
                <div className="space-y-2 text-sm">
                  <div className="flex items-center gap-2">
                    <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span>AI Assistant: Operational</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span>Knowledge Banks: Operational</span>
                  </div>
                  <div className="flex items-center gap-2">
                    <div className="w-2 h-2 bg-green-500 rounded-full"></div>
                    <span>Document Upload: Operational</span>
                  </div>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </>
  );
};

export default HelpCenter;